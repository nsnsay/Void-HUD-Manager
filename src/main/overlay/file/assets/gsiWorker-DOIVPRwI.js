(function(){"use strict";self.addEventListener("message",t=>{const e=t.data;try{if(!e||e.type!=="gsi-data")return;const s=performance.now(),n=e.payload,r=u(n),a=performance.now(),c={type:"gsi-processed",payload:r,meta:{receivedAt:s,processedAt:a,latencyMs:a-s}},o=[];f(c.payload,o),self.postMessage(c,o)}catch(s){self.postMessage({type:"gsi-error",error:y(s)})}});function u(t){const e={receivedAtIso:new Date().toISOString()};try{const s=typeof globalThis.structuredClone=="function"?globalThis.structuredClone(t):JSON.parse(JSON.stringify(t)),n={};return i(s,(r,a)=>{if(Array.isArray(r)&&r.length&&r.every(c=>typeof c=="number")){const c=r.reduce((g,l)=>g+l,0),o=Math.min(...r),d=Math.max(...r),p=c/r.length;n[a.join(".")]={count:r.length,sum:c,min:o,max:d,mean:p}}}),{data:s,stats:n,summary:e}}catch{return{data:t,summary:e}}}function i(t,e,s=[]){if(Array.isArray(t)){e(t,s),t.forEach((n,r)=>i(n,e,s.concat(String(r))));return}t&&typeof t=="object"&&Object.keys(t).forEach(n=>i(t[n],e,s.concat(n)))}function f(t,e){if(t){if(t instanceof ArrayBuffer){e.push(t);return}if(ArrayBuffer.isView(t)){e.push(t.buffer);return}if(Array.isArray(t)){t.forEach(s=>f(s,e));return}if(typeof t=="object")for(const s in t)f(t[s],e)}}function y(t){return{message:(t==null?void 0:t.message)??String(t),stack:t==null?void 0:t.stack}}})();
